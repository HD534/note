## CAS（compare and swap） ##
[https://howtodoinjava.com/java/multi-threading/compare-and-swap-cas-algorithm/](https://howtodoinjava.com/java/multi-threading/compare-and-swap-cas-algorithm/)

### 悲观锁和乐观锁 
使用`synchronized` 关键字是类似悲观锁的机制，它要求首先保证没有其他线程会干扰某些操作（即锁定对象），然后只允许你访问任何实例/方法。
虽然这样是线程安全的，但是性能方面却会造成影响，因为其他线程必须等到当前持有锁的线程释放锁它们才能继续运行。

还有一种方法在性能上更有效，并且本质上是乐观的。在这种方法中，你继续进行更新，希望你可以不受干扰地完成更新。该方法依赖于冲突检测来确定在更新期间是否存在来自其他方的干扰，在这种情况下如果操作失败可以重试（或不重试）。
CAS 是乐观方法的一个很好的例子。

### CAS 算法
CAS 是将内存中的值与给定的值进行比较，只有两个值相同时，才将内存中的值修改为新给定的值。这是作为单个原子操作完成的。原子性保证了内存中的新值是基于最新信息计算出来的，如果在此期间该值已被另一个线程更新，则写入失败。
操作的结果必须表明它是否进行了替换;这可以通过简单的布尔响应（此变体通常称为 compare-and-set ），或通过返回从内存位置读取的值（而不是写入它的值）来完成。
CAS操作有3个参数：
1. 一个要被替换的内存位置V上的值
2. 旧的值A被一个线程读取
3. 新的值B将要写在内存位置V上